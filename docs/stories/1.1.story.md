# <!-- Powered by BMAD™ Core -->

# Story 1.1: Project Setup and Development Environment

## Status
InProgress

## Story
**As a** developer,  
**I want** a complete React Native project with backend API setup and all necessary development tools configured,  
**so that** I can efficiently develop and deploy the bus tracking application.

## Acceptance Criteria
1. React Native project initialized with proper folder structure and dependencies
2. Node.js backend API with Express framework setup and basic routing
3. Database (Supabase PostgreSQL) connection configured and tested
4. Development environment supports hot reloading for both frontend and backend
5. Git repository configured with proper .gitignore and initial commit structure
6. Basic CI/CD pipeline established for automated testing and deployment

## Tasks / Subtasks
- [x] Initialize monorepo structure with yarn workspaces (AC: 1)
  - [x] Create root package.json with workspaces configuration
  - [x] Set up unified project structure as defined in architecture
  - [x] Configure shared packages for types, utils, and config
- [x] Set up React Native mobile application (AC: 1)
  - [x] Initialize React Native CLI project in apps/mobile/
  - [x] Install required dependencies: react-native-maps, geolocation, zustand
  - [x] Configure TypeScript with proper tsconfig
  - [x] Set up folder structure: components, screens, services, hooks, store, types
- [x] Set up Express.js backend API (AC: 2)
  - [x] Initialize Express.js project in apps/backend/
  - [x] Install dependencies: express, socket.io, typescript, nodemon
  - [x] Configure basic routing structure in src/routes/
  - [x] Set up middleware directory and basic middleware
  - [x] Configure WebSocket service with Socket.IO
- [x] Configure database connection (AC: 3)
  - [x] Set up Supabase PostgreSQL connection
  - [x] Create database configuration in backend services
  - [x] Test connection with basic health check endpoint
- [x] Configure development environment (AC: 4)
  - [x] Set up hot reloading for React Native
  - [x] Configure nodemon for backend hot reloading  
  - [x] Create development scripts in root package.json
  - [x] Set up environment variable templates with security considerations
  - [x] Configure proper .gitignore to exclude secrets and sensitive files
- [ ] Initialize git repository (AC: 5)
  - [ ] Create comprehensive .gitignore for React Native and Node.js
  - [ ] Configure git repository with initial commit
  - [ ] Set up branch protection for main branch (require PR reviews, status checks, restrict pushes)
- [ ] Set up CI/CD pipeline (AC: 6)
  - [ ] Create GitHub Actions workflow for backend deployment
  - [ ] Configure automated testing pipeline
  - [ ] Set up Render.com deployment configuration
- [ ] Create comprehensive testing setup (Testing Requirements)
  - [ ] Configure Jest + React Native Testing Library for frontend
  - [ ] Set up Jest + Supertest for backend API testing
  - [ ] Create test directory structure as per testing strategy
  - [ ] Set up Detox for E2E testing configuration

## Dev Notes

### Previous Story Insights
No previous story context available - this is the first story in the project.

### Tech Stack Requirements
[Source: architecture/tech-stack.md]
- **Frontend**: React Native CLI 0.72+ (no Expo limitations)
- **Maps**: react-native-maps 1.8+ for Google Maps integration
- **Location**: @react-native-community/geolocation 3.0+ for GPS access
- **State Management**: Zustand 4.4+ for lightweight state management
- **Backend**: Express.js 4.18+ with Socket.IO 4.7+ for REST API and WebSocket
- **Database**: Supabase PostgreSQL 15+ with real-time capabilities
- **Cache**: Node-cache 5.1+ for in-memory caching
- **Testing**: Jest + React Native Testing Library, Jest + Supertest, Detox 20.0+
- **CI/CD**: GitHub Actions for automated deployment
- **Hosting**: Render.com for backend deployment
- **Monitoring**: Sentry for error tracking

### Project Structure Requirements
[Source: architecture/unified-project-structure.md]
```
cvr-college-bus-tracker/
├── .github/workflows/           # CI/CD workflows
├── apps/
│   ├── mobile/                  # React Native application
│   │   ├── android/             # Native Android configuration
│   │   ├── ios/                 # Native iOS configuration
│   │   ├── src/
│   │   │   ├── components/      # UI components
│   │   │   ├── screens/         # Screen components
│   │   │   ├── services/        # API and external services
│   │   │   ├── hooks/           # Custom React hooks
│   │   │   ├── store/           # State management
│   │   │   └── types/           # TypeScript types
│   │   └── package.json
│   └── backend/                 # Express.js API server
│       ├── src/
│       │   ├── controllers/     # Request handlers
│       │   ├── routes/          # Route definitions
│       │   ├── services/        # Business logic
│       │   ├── middleware/      # Express middleware
│       │   ├── websocket/       # Socket.IO handlers
│       │   └── types/           # TypeScript types
│       ├── tests/               # Backend tests
│       └── package.json
├── packages/                    # Shared packages
│   ├── shared-types/            # Common TypeScript types
│   ├── utils/                   # Shared utility functions
│   └── config/                  # Shared configuration
├── scripts/                     # Development and build scripts
├── docs/                        # Project documentation
├── package.json                 # Root package.json with workspaces
└── README.md
```

### Development Workflow Setup
[Source: architecture/development-workflow.md]

**Prerequisites:**
- Node.js 18+
- Yarn package manager
- React Native CLI

**Development Commands:**
- `yarn dev` - Start all services
- `yarn test` - Run all tests
- `yarn build` - Build for production

**Environment Configuration:**
- Mobile (.env.local): API_BASE_URL, WEBSOCKET_URL, GOOGLE_MAPS_API_KEY, DEBUG
- Backend (.env): NODE_ENV, PORT, SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY

### Coding Standards Requirements
[Source: architecture/coding-standards.md]

**Critical Fullstack Rules:**
- Type Sharing: Always define types in packages/shared-types and import from there
- API Calls: Never make direct HTTP calls - use the service layer
- Environment Variables: Access only through config objects, never process.env directly
- Error Handling: All API routes must use the standard error handler
- State Updates: Never mutate state directly - use proper state management patterns

**Naming Conventions:**
- Components: PascalCase (e.g., `UserProfile.tsx`)
- Hooks: camelCase with 'use' prefix (e.g., `useAuth.ts`)
- API Routes: kebab-case (e.g., `/api/user-profile`)
- Database Tables: snake_case (e.g., `bus_sessions`)

### Deployment Configuration
[Source: architecture/deployment-architecture.md]

**Backend Deployment:**
- Platform: Render.com (Free Tier)
- Build Command: `yarn install && yarn workspace backend build`
- Deployment Method: Git-based continuous deployment

**CI/CD Pipeline Requirements:**
- GitHub Actions workflow for backend deployment on main branch changes
- Automated testing before deployment
- Environment variables managed through Render.com secrets

### Security Considerations for Project Setup
[Source: architecture/coding-standards.md]

**Environment Security:**
- Never commit environment variables or secrets to git repository
- Use .env files for local development only
- Environment variables must be accessed through config objects, never process.env directly
- Set up proper .gitignore to exclude all environment files (.env, .env.local, .env.production)

**Secrets Management:**
- Store production secrets in Render.com environment variables
- Use placeholder values in .env.example files
- Ensure Supabase service role keys are properly secured
- Google Maps API keys should be restricted by application/domain

**Repository Security:**
- Configure branch protection rules to require PR reviews
- Enable status checks before merging
- Restrict direct pushes to main branch
- Set up automated security scanning if available

### Testing Standards
[Source: architecture/testing-strategy.md]

**Test Organization:**
```
Frontend Tests: apps/mobile/__tests__/
├── components/
├── screens/
├── services/
└── __mocks__/

Backend Tests: apps/backend/tests/
├── unit/
│   ├── controllers/
│   └── services/
├── integration/
│   └── routes/
└── fixtures/
```

**Testing Pyramid:**
- E2E Tests (Detox)
- Integration Tests
- Frontend Unit Tests (Jest + React Native Testing Library)
- Backend Unit Tests (Jest + Supertest)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-07 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-09-07 | 1.1 | Fixed database reference (MongoDB→Supabase PostgreSQL), added security considerations, enhanced branch protection specification | Sarah (Product Owner) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here after implementation*